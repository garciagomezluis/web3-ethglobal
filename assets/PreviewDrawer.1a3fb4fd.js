import{G as w,r as h,u as A,a as F,b as O,c as N,j as n,F as y,d as P,e as i,M as L,V as m,T as x,C as W,f as D,B as V,L as H,g as G,h as U,i as $,k as q,l as C,I as J,H as k,m as M,S as R,A as X,n as Y,o as K,p as Q,q as Z,D as ee,s as te,t as ne,v as ae}from"./index.e5926376.js";function re(e){return w({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"}}]})(e)}function oe(e){return w({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"}}]})(e)}function se(e){return w({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z",clipRule:"evenodd"}}]})(e)}function ie(e){return w({tag:"svg",attr:{viewBox:"0 0 20 20",fill:"currentColor"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"}}]})(e)}const le=({pages:e,initialPage:a})=>{typeof a=="undefined"&&([a]=e);const[t,r]=h.exports.useState(a),{value:o,increment:s,decrement:l}=A({minValue:0,maxValue:e.length});return h.exports.useEffect(()=>{r(e[o])},[o]),{setPage:c=>{if(!e.includes(c))throw new Error("page must be declared");r(c)},page:t,next:s,prev:l}},ce=[{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"collections",outputs:[{internalType:"contract LayeralizeNFTContract",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"string",name:"ipfsCID",type:"string"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"createCollection",outputs:[],stateMutability:"nonpayable",type:"function"}],de="0x0BD6166f462896AeaC4ba5cABDbf2c2eDbDD076C",ue=async e=>{const a=new FormData;for(const r of e)a.append(r.name,r);return(await fetch("https://lucho-nft.herokuapp.com/nft/images",{method:"POST",body:a})).json()},he=async(e,a)=>{const t=e.map((o,s)=>pe(o,a[s],s));return(await fetch("https://lucho-nft.herokuapp.com/nft/metadata",{method:"POST",body:JSON.stringify({metadata:t}),headers:{"Content-Type":"application/json"}})).json()},pe=(e,a,t)=>({description:`Test collection. Layeralize. ETH GLOBAL 2022. Token #${t}`,external_url:"https://github.com/garciagomezluis/web3-ethglobal",image:e,name:`Layeralize ETH Global Collection #${t}`,attributes:a.map(r=>({trait_type:r.name,value:r.value}))}),S=e=>{const[a,t]=h.exports.useState(!1),[r,o]=h.exports.useState(!1),[s,l]=h.exports.useState(null),[d,c]=h.exports.useState();return{go:async(...f)=>{o(!1),t(!0),l(null);let u=null;try{u=await e(...f)}catch(g){c(g)}return t(!1),o(!0),l(u),u},done:r,doing:a,data:s,error:d}},ge=(e,a)=>{const{config:t}=F({addressOrName:de,contractInterface:ce,functionName:"createCollection",enabled:e!==null,args:[e,a]}),{writeAsync:r,data:o}=O(t),{status:s}=N({hash:o==null?void 0:o.hash});return{writeAsync:r,status:s,txHash:o==null?void 0:o.hash}},fe=(e,a)=>{const t=S(ue),r=S(he);return{images:t,metadata:r,publish:async()=>{const{filenames:s}=await t.go(e),{cid:l}=await r.go(s,a);return l}}},me=({files:e,attrs:a})=>{const[t,r]=h.exports.useState(""),{images:o,metadata:s,publish:l}=fe(e,a),{go:d,done:c,doing:p,data:f}=S(l),{writeAsync:u,status:g,txHash:I}=ge(f,e.length),z=g==="error"||t!=="",v=g==="success"||z,b=c&&!v,B={error:z,done:v,doing:b,hash:I},E=p||b,_=c&&v;return h.exports.useEffect(()=>{d(e,a)},[]),h.exports.useEffect(()=>{b&&u&&u().catch(j=>r(`Please, try again: ${j.message}`))},[u]),h.exports.useEffect(()=>{g==="error"&&r("Please, check the transaction and try again")},[g]),{images:o,metadata:s,tx:B,doing:E,done:_,error:t}},T=({doing:e,done:a,error:t,children:r})=>{let o=se;return e&&(o=re),a&&(o=oe),t&&(o=ie),i(U,{children:[o&&n($,{as:o,color:"pink.500"}),r]})},xe=({images:e,metadata:a,tx:t})=>{const{doing:r,done:o,error:s}=e,{doing:l,done:d,error:c}=a,{doing:p,done:f,error:u,hash:g}=t;return i(y,{children:[i(m,{w:"full",children:[n(x,{color:"pink.500",fontWeight:"bold",w:"full",children:"Uploading resources"}),i(H,{mt:"15px !important",spacing:3,w:"full",children:[n(T,{doing:r,done:o,error:s,children:"Uploading images to IPFS"}),n(T,{doing:l,done:d,error:c,children:"Uploading NFTs metadata"})]})]}),i(m,{mt:"5",w:"full",children:[n(x,{color:"pink.500",fontWeight:"bold",w:"full",children:"Finally"}),n(H,{spacing:3,w:"full",children:i(T,{doing:p,done:f,error:u,children:["Transaction sign",g&&n(G,{color:"pink.500",href:`https://mumbai.polygonscan.com/tx/${g}`,ml:"20",target:"_blank",children:"View on block explorer"})]})})]})]})},we=({files:e,onMintConfirm:a})=>{const{address:t}=P();return i(y,{children:[n(L,{children:i(m,{children:[i(x,{children:[e.length," images will integrate the collection. This might take a few minutes. You will be required to sign a transaction as the last operation with a network fee. Please, do not close the tab once confirmed."]}),n(W,{mt:"2",p:"1",children:t})]})}),n(D,{children:n(V,{onClick:a,children:"Confirm"})})]})},ye=({files:e,attrs:a,onMintEnd:t})=>{const{images:r,metadata:o,tx:s,doing:l,done:d,error:c}=me({files:e,attrs:a});return i(y,{children:[i(L,{children:[n(xe,{images:r,metadata:o,tx:s}),d&&n(x,{mt:"5",children:c||"Collection uploaded successfully"})]}),n(D,{children:n(V,{isLoading:l,loadingText:"Loading",onClick:()=>t(c),children:"Done"})})]})},ve=({onMintStart:e,onMintEnd:a,files:t,attrs:r})=>{const{page:o,setPage:s}=le({pages:["disclaimer","progress"]}),l=async()=>{e(),s("progress")};return o==="disclaimer"?n(we,{files:t,onMintConfirm:l}):o==="progress"?n(ye,{attrs:r,files:t,onMintEnd:a}):n(y,{})};function be(e){return w({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"}},{tag:"path",attr:{fillRule:"evenodd",d:"M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"}}]})(e)}const Ce=({name:e,value:a,usage:t})=>{const r=q("Trait",{});return i(m,{__css:r.trait,children:[n(C.p,{__css:r.name,children:e}),n(C.p,{__css:r.value,children:a}),i(C.p,{__css:r.usage,children:[t,"% have this trait"]})]})},Me=({images:e,traits:a})=>{const{value:t,increment:r,decrement:o,atLowest:s,atGreatest:l}=A({initialValue:0,minValue:0,maxValue:e.length-1}),d=h.exports.useRef(null);return h.exports.useEffect(()=>{d.current!==null&&(d.current.src=e[t])},[t,e]),i(m,{justify:"center",children:[i(m,{w:"300px",children:[i(x,{color:"pink.500",fontSize:"x-large",fontWeight:"semibold",letterSpacing:"2px",textAlign:"right",w:"full",children:[t+1,"/",e.length]}),n(J,{ref:d,boxSize:"300px"}),i(k,{justify:"center",w:"full",children:[n(M,{disabled:!0,"aria-label":"remove",icon:n(be,{}),onClick:()=>{}}),n(R,{}),n(M,{"aria-label":"prev",disabled:s,icon:n(X,{}),onClick:o}),n(M,{"aria-label":"next",disabled:l,icon:n(Y,{}),onClick:r})]})]}),n(k,{justify:"center",mt:"30px !important",w:"full",wrap:"wrap",children:a.length>0&&a[t].map(({id:c,name:p,usage:f,value:u})=>n(K,{m:"5px !important",children:n(Ce,{id:c,name:p,usage:f,value:u})},c))})]})},ke=({isOpen:e,onClose:a,onMintEnd:t})=>{const{isConnected:r}=P(),{open:o,close:s,toggleLock:l}=Q(),{files:d,images:c,traits:p}=Z();return i(ee,{isOpen:e,size:"md",onClose:a,children:[n(te,{}),i(ne,{children:[n(ae,{bg:"pink.500",color:"white",fontSize:"xl",children:"Collection preview"}),n(L,{children:n(Me,{images:c,traits:p})}),n(D,{children:i(k,{w:"full",children:[n(R,{}),n(V,{disabled:!r,onClick:()=>{o({element:ve,props:{onMintEnd:u=>{s(),u||t()},onMintStart:()=>l(),attrs:p,files:d},locked:!1,title:"Collection minting"})},children:"Mint collection"})]})})]})]})};export{ke as default};
